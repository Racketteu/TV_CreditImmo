using CreditImmo;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace TestUnitaireCreditImmo
{
    public class TestCSV
    {
        [Theory]
        [InlineData(300, 100000, 10)]
        public void CSVMakeTest(int duration, double amount, double nominalRate)
        {
            CustomerInput customerInput = new CustomerInput(duration, amount, nominalRate);
            CSV csv = new CSV();
            string result = csv.CSVMake(customerInput);
            Assert.Equal("Number; Monthly payment; Capital remaining; Capital repaid\r\n1;908,7;272610;0\r\n2;908,7;271701,3;908,7\r\n3;908,7;270792,6;1817,4\r\n4;908,7;269883,89999999997;2726,1000000000004\r\n5;908,7;268975,19999999995;3634,8\r\n6;908,7;268066,49999999994;4543,5\r\n7;908,7;267157,79999999993;5452,2\r\n8;908,7;266249,0999999999;6360,9\r\n9;908,7;265340,3999999999;7269,599999999999\r\n10;908,7;264431,6999999999;8178,299999999999\r\n11;908,7;263522,9999999999;9087\r\n12;908,7;262614,2999999999;9995,7\r\n13;908,7;261705,59999999986;10904,400000000001\r\n14;908,7;260796,89999999985;11813,100000000002\r\n15;908,7;259888,19999999984;12721,800000000003\r\n16;908,7;258979,49999999983;13630,500000000004\r\n17;908,7;258070,7999999998;14539,200000000004\r\n18;908,7;257162,0999999998;15447,900000000005\r\n19;908,7;256253,3999999998;16356,600000000006\r\n20;908,7;255344,69999999978;17265,300000000007\r\n21;908,7;254435,99999999977;18174,000000000007\r\n22;908,7;253527,29999999976;19082,700000000008\r\n23;908,7;252618,59999999974;19991,40000000001\r\n24;908,7;251709,89999999973;20900,10000000001\r\n25;908,7;250801,19999999972;21808,80000000001\r\n26;908,7;249892,4999999997;22717,50000000001\r\n27;908,7;248983,7999999997;23626,20000000001\r\n28;908,7;248075,0999999997;24534,900000000012\r\n29;908,7;247166,39999999967;25443,600000000013\r\n30;908,7;246257,69999999966;26352,300000000014\r\n31;908,7;245348,99999999965;27261,000000000015\r\n32;908,7;244440,29999999964;28169,700000000015\r\n33;908,7;243531,59999999963;29078,400000000016\r\n34;908,7;242622,89999999962;29987,100000000017\r\n35;908,7;241714,1999999996;30895,800000000017\r\n36;908,7;240805,4999999996;31804,50000000002\r\n37;908,7;239896,79999999958;32713,20000000002\r\n38;908,7;238988,09999999957;33621,900000000016\r\n39;908,7;238079,39999999956;34530,60000000001\r\n40;908,7;237170,69999999955;35439,30000000001\r\n41;908,7;236261,99999999953;36348,00000000001\r\n42;908,7;235353,29999999952;37256,700000000004\r\n43;908,7;234444,5999999995;38165,4\r\n44;908,7;233535,8999999995;39074,1\r\n45;908,7;232627,1999999995;39982,799999999996\r\n46;908,7;231718,49999999948;40891,49999999999\r\n47;908,7;230809,79999999946;41800,19999999999\r\n48;908,7;229901,09999999945;42708,89999999999\r\n49;908,7;228992,39999999944;43617,599999999984\r\n50;908,7;228083,69999999943;44526,29999999998\r\n51;908,7;227174,99999999942;45434,99999999998\r\n52;908,7;226266,2999999994;46343,699999999975\r\n53;908,7;225357,5999999994;47252,39999999997\r\n54;908,7;224448,89999999938;48161,09999999997\r\n55;908,7;223540,19999999937;49069,79999999997\r\n56;908,7;222631,49999999936;49978,49999999996\r\n57;908,7;221722,79999999935;50887,19999999996\r\n58;908,7;220814,09999999934;51795,89999999996\r\n59;908,7;219905,39999999932;52704,599999999955\r\n60;908,7;218996,6999999993;53613,29999999995\r\n61;908,7;218087,9999999993;54521,99999999995\r\n62;908,7;217179,2999999993;55430,699999999946\r\n63;908,7;216270,59999999928;56339,39999999994\r\n64;908,7;215361,89999999927;57248,09999999994\r\n65;908,7;214453,19999999925;58156,79999999994\r\n66;908,7;213544,49999999924;59065,499999999935\r\n67;908,7;212635,79999999923;59974,19999999993\r\n68;908,7;211727,09999999922;60882,89999999993\r\n69;908,7;210818,3999999992;61791,599999999926\r\n70;908,7;209909,6999999992;62700,29999999992\r\n71;908,7;209000,99999999919;63608,99999999992\r\n72;908,7;208092,29999999917;64517,69999999992\r\n73;908,7;207183,59999999916;65426,399999999914\r\n74;908,7;206274,89999999915;66335,09999999992\r\n75;908,7;205366,19999999914;67243,79999999992\r\n76;908,7;204457,49999999913;68152,49999999991\r\n77;908,7;203548,79999999912;69061,19999999991\r\n78;908,7;202640,0999999991;69969,8999999999\r\n79;908,7;201731,3999999991;70878,5999999999\r\n80;908,7;200822,69999999908;71787,2999999999\r\n81;908,7;199913,99999999907;72695,9999999999\r\n82;908,7;199005,29999999906;73604,6999999999\r\n83;908,7;198096,59999999905;74513,39999999989\r\n84;908,7;197187,89999999903;75422,09999999989\r\n85;908,7;196279,19999999902;76330,79999999989\r\n86;908,7;195370,499999999;77239,49999999988\r\n87;908,7;194461,799999999;78148,19999999988\r\n88;908,7;193553,099999999;79056,89999999988\r\n89;908,7;192644,39999999898;79965,59999999987\r\n90;908,7;191735,69999999896;80874,29999999987\r\n91;908,7;190826,99999999895;81782,99999999987\r\n92;908,7;189918,29999999894;82691,69999999987\r\n93;908,7;189009,59999999893;83600,39999999986\r\n94;908,7;188100,89999999892;84509,09999999986\r\n95;908,7;187192,1999999989;85417,79999999986\r\n96;908,7;186283,4999999989;86326,49999999985\r\n97;908,7;185374,79999999888;87235,19999999985\r\n98;908,7;184466,09999999887;88143,89999999985\r\n99;908,7;183557,39999999886;89052,59999999985\r\n100;908,7;182648,69999999885;89961,29999999984\r\n101;908,7;181739,99999999884;90869,99999999984\r\n102;908,7;180831,29999999882;91778,69999999984\r\n103;908,7;179922,5999999988;92687,39999999983\r\n104;908,7;179013,8999999988;93596,09999999983\r\n105;908,7;178105,1999999988;94504,79999999983\r\n106;908,7;177196,49999999878;95413,49999999983\r\n107;908,7;176287,79999999877;96322,19999999982\r\n108;908,7;175379,09999999875;97230,89999999982\r\n109;908,7;174470,39999999874;98139,59999999982\r\n110;908,7;173561,69999999873;99048,29999999981\r\n111;908,7;172652,99999999872;99956,99999999981\r\n112;908,7;171744,2999999987;100865,69999999981\r\n113;908,7;170835,5999999987;101774,3999999998\r\n114;908,7;169926,89999999868;102683,0999999998\r\n115;908,7;169018,19999999867;103591,7999999998\r\n116;908,7;168109,49999999866;104500,4999999998\r\n117;908,7;167200,79999999865;105409,1999999998\r\n118;908,7;166292,09999999864;106317,89999999979\r\n119;908,7;165383,39999999863;107226,59999999979\r\n120;908,7;164474,69999999861;108135,29999999978\r\n121;908,7;163565,9999999986;109043,99999999978\r\n122;908,7;162657,2999999986;109952,69999999978\r\n123;908,7;161748,59999999858;110861,39999999978\r\n124;908,7;160839,89999999857;111770,09999999977\r\n125;908,7;159931,19999999856;112678,79999999977\r\n126;908,7;159022,49999999854;113587,49999999977\r\n127;908,7;158113,79999999853;114496,19999999976\r\n128;908,7;157205,09999999852;115404,89999999976\r\n129;908,7;156296,3999999985;116313,59999999976\r\n130;908,7;155387,6999999985;117222,29999999976\r\n131;908,7;154478,9999999985;118130,99999999975\r\n132;908,7;153570,29999999847;119039,69999999975\r\n133;908,7;152661,59999999846;119948,39999999975\r\n134;908,7;151752,89999999845;120857,09999999974\r\n135;908,7;150844,19999999844;121765,79999999974\r\n136;908,7;149935,49999999843;122674,49999999974\r\n137;908,7;149026,79999999842;123583,19999999974\r\n138;908,7;148118,0999999984;124491,89999999973\r\n139;908,7;147209,3999999984;125400,59999999973\r\n140;908,7;146300,69999999838;126309,29999999973\r\n141;908,7;145391,99999999837;127217,99999999972\r\n142;908,7;144483,29999999836;128126,69999999972\r\n143;908,7;143574,59999999835;129035,39999999972\r\n144;908,7;142665,89999999834;129944,09999999971\r\n145;908,7;141757,19999999832;130852,79999999971\r\n146;908,7;140848,4999999983;131761,4999999997\r\n147;908,7;139939,7999999983;132670,19999999972\r\n148;908,7;139031,0999999983;133578,89999999973\r\n149;908,7;138122,39999999828;134487,59999999974\r\n150;908,7;137213,69999999827;135396,29999999976\r\n151;908,7;136304,99999999825;136304,99999999977\r\n152;908,7;135396,29999999824;137213,69999999978\r\n153;908,7;134487,59999999823;138122,3999999998\r\n154;908,7;133578,89999999822;139031,0999999998\r\n155;908,7;132670,1999999982;139939,7999999998\r\n156;908,7;131761,4999999982;140848,49999999983\r\n157;908,7;130852,7999999982;141757,19999999984\r\n158;908,7;129944,0999999982;142665,89999999985\r\n159;908,7;129035,3999999982;143574,59999999986\r\n160;908,7;128126,6999999982;144483,29999999987\r\n161;908,7;127217,99999999821;145391,99999999988\r\n162;908,7;126309,29999999821;146300,6999999999\r\n163;908,7;125400,59999999822;147209,3999999999\r\n164;908,7;124491,89999999822;148118,09999999992\r\n165;908,7;123583,19999999822;149026,79999999993\r\n166;908,7;122674,49999999822;149935,49999999994\r\n167;908,7;121765,79999999823;150844,19999999995\r\n168;908,7;120857,09999999823;151752,89999999997\r\n169;908,7;119948,39999999823;152661,59999999998\r\n170;908,7;119039,69999999824;153570,3\r\n171;908,7;118130,99999999824;154479\r\n172;908,7;117222,29999999824;155387,7\r\n173;908,7;116313,59999999825;156296,40000000002\r\n174;908,7;115404,89999999825;157205,10000000003\r\n175;908,7;114496,19999999825;158113,80000000005\r\n176;908,7;113587,49999999825;159022,50000000006\r\n177;908,7;112678,79999999826;159931,20000000007\r\n178;908,7;111770,09999999826;160839,90000000008\r\n179;908,7;110861,39999999826;161748,6000000001\r\n180;908,7;109952,69999999827;162657,3000000001\r\n181;908,7;109043,99999999827;163566,00000000012\r\n182;908,7;108135,29999999827;164474,70000000013\r\n183;908,7;107226,59999999827;165383,40000000014\r\n184;908,7;106317,89999999828;166292,10000000015\r\n185;908,7;105409,19999999828;167200,80000000016\r\n186;908,7;104500,49999999828;168109,50000000017\r\n187;908,7;103591,79999999829;169018,2000000002\r\n188;908,7;102683,09999999829;169926,9000000002\r\n189;908,7;101774,39999999829;170835,6000000002\r\n190;908,7;100865,6999999983;171744,30000000022\r\n191;908,7;99956,9999999983;172653,00000000023\r\n192;908,7;99048,2999999983;173561,70000000024\r\n193;908,7;98139,5999999983;174470,40000000026\r\n194;908,7;97230,8999999983;175379,10000000027\r\n195;908,7;96322,19999999831;176287,80000000028\r\n196;908,7;95413,49999999831;177196,5000000003\r\n197;908,7;94504,79999999831;178105,2000000003\r\n198;908,7;93596,09999999832;179013,9000000003\r\n199;908,7;92687,39999999832;179922,60000000033\r\n200;908,7;91778,69999999832;180831,30000000034\r\n201;908,7;90869,99999999833;181740,00000000035\r\n202;908,7;89961,29999999833;182648,70000000036\r\n203;908,7;89052,59999999833;183557,40000000037\r\n204;908,7;88143,89999999834;184466,10000000038\r\n205;908,7;87235,19999999834;185374,8000000004\r\n206;908,7;86326,49999999834;186283,5000000004\r\n207;908,7;85417,79999999834;187192,20000000042\r\n208;908,7;84509,09999999835;188100,90000000043\r\n209;908,7;83600,39999999835;189009,60000000044\r\n210;908,7;82691,69999999835;189918,30000000045\r\n211;908,7;81782,99999999836;190827,00000000047\r\n212;908,7;80874,29999999836;191735,70000000048\r\n213;908,7;79965,59999999836;192644,4000000005\r\n214;908,7;79056,89999999836;193553,1000000005\r\n215;908,7;78148,19999999837;194461,8000000005\r\n216;908,7;77239,49999999837;195370,50000000052\r\n217;908,7;76330,79999999837;196279,20000000054\r\n218;908,7;75422,09999999838;197187,90000000055\r\n219;908,7;74513,39999999838;198096,60000000056\r\n220;908,7;73604,69999999838;199005,30000000057\r\n221;908,7;72695,99999999838;199914,00000000058\r\n222;908,7;71787,29999999839;200822,7000000006\r\n223;908,7;70878,59999999839;201731,4000000006\r\n224;908,7;69969,8999999984;202640,10000000062\r\n225;908,7;69061,1999999984;203548,80000000063\r\n226;908,7;68152,4999999984;204457,50000000064\r\n227;908,7;67243,7999999984;205366,20000000065\r\n228;908,7;66335,0999999984;206274,90000000066\r\n229;908,7;65426,39999999841;207183,60000000068\r\n230;908,7;64517,69999999841;208092,3000000007\r\n231;908,7;63608,999999998414;209001,0000000007\r\n232;908,7;62700,29999999842;209909,7000000007\r\n233;908,7;61791,59999999842;210818,40000000072\r\n234;908,7;60882,89999999842;211727,10000000073\r\n235;908,7;59974,199999998425;212635,80000000075\r\n236;908,7;59065,49999999843;213544,50000000076\r\n237;908,7;58156,79999999843;214453,20000000077\r\n238;908,7;57248,099999998434;215361,90000000078\r\n239;908,7;56339,39999999844;216270,6000000008\r\n240;908,7;55430,69999999844;217179,3000000008\r\n241;908,7;54521,99999999844;218088,00000000081\r\n242;908,7;53613,299999998446;218996,70000000083\r\n243;908,7;52704,59999999845;219905,40000000084\r\n244;908,7;51795,89999999845;220814,10000000085\r\n245;908,7;50887,199999998455;221722,80000000086\r\n246;908,7;49978,49999999846;222631,50000000087\r\n247;908,7;49069,79999999846;223540,20000000088\r\n248;908,7;48161,09999999846;224448,9000000009\r\n249;908,7;47252,399999998466;225357,6000000009\r\n250;908,7;46343,69999999847;226266,30000000092\r\n251;908,7;45434,99999999847;227175,00000000093\r\n252;908,7;44526,299999998475;228083,70000000094\r\n253;908,7;43617,59999999848;228992,40000000095\r\n254;908,7;42708,89999999848;229901,10000000097\r\n255;908,7;41800,199999998484;230809,80000000098\r\n256;908,7;40891,49999999849;231718,500000001\r\n257;908,7;39982,79999999849;232627,200000001\r\n258;908,7;39074,09999999849;233535,900000001\r\n259;908,7;38165,399999998495;234444,60000000102\r\n260;908,7;37256,6999999985;235353,30000000104\r\n261;908,7;36347,9999999985;236262,00000000105\r\n262;908,7;35439,299999998504;237170,70000000106\r\n263;908,7;34530,59999999851;238079,40000000107\r\n264;908,7;33621,89999999851;238988,10000000108\r\n265;908,7;32713,19999999851;239896,8000000011\r\n266;908,7;31804,49999999851;240805,5000000011\r\n267;908,7;30895,799999998508;241714,20000000112\r\n268;908,7;29987,099999998507;242622,90000000113\r\n269;908,7;29078,399999998506;243531,60000000114\r\n270;908,7;28169,699999998506;244440,30000000115\r\n271;908,7;27260,999999998505;245349,00000000116\r\n272;908,7;26352,299999998504;246257,70000000118\r\n273;908,7;25443,599999998503;247166,4000000012\r\n274;908,7;24534,899999998503;248075,1000000012\r\n275;908,7;23626,199999998502;248983,8000000012\r\n276;908,7;22717,4999999985;249892,50000000122\r\n277;908,7;21808,7999999985;250801,20000000123\r\n278;908,7;20900,0999999985;251709,90000000125\r\n279;908,7;19991,3999999985;252618,60000000126\r\n280;908,7;19082,6999999985;253527,30000000127\r\n281;908,7;18173,999999998498;254436,00000000128\r\n282;908,7;17265,299999998497;255344,7000000013\r\n283;908,7;16356,599999998496;256253,4000000013\r\n284;908,7;15447,899999998495;257162,10000000132\r\n285;908,7;14539,199999998495;258070,80000000133\r\n286;908,7;13630,499999998494;258979,50000000134\r\n287;908,7;12721,799999998493;259888,20000000135\r\n288;908,7;11813,099999998492;260796,90000000136\r\n289;908,7;10904,399999998492;261705,60000000137\r\n290;908,7;9995,699999998491;262614,3000000014\r\n291;908,7;9086,99999999849;263523,0000000014\r\n292;908,7;8178,29999999849;264431,7000000014\r\n293;908,7;7269,599999998491;265340,4000000014\r\n294;908,7;6360,899999998491;266249,10000000143\r\n295;908,7;5452,199999998491;267157,80000000144\r\n296;908,7;4543,499999998491;268066,50000000146\r\n297;908,7;3634,7999999984913;268975,20000000147\r\n298;908,7;2726,0999999984915;269883,9000000015\r\n299;908,7;1817,3999999984915;270792,6000000015\r\n300;908,7;908,6999999984914;271701,3000000015\r\n", result);
        }

    }
}
